2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Current SDK version is 0.16.1
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Configure stats pid to 1927
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Loading settings from /Users/Terru/.config/wandb/settings
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Loading settings from /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/settings
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'project': 'switch_moe', 'entity': 'terru3', 'root_dir': '/Users/Terru/Desktop/self-learn/moe-kit/switch_transformer', 'sweep_id': 'qdyn9o0q', 'run_id': '8yp8mllr', 'sweep_param_path': '/Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/sweep-qdyn9o0q/config-8yp8mllr.yaml'}
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program': '<python with no main file>'}
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_init.py:_log_setup():524] Logging user logs to /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/run-20231224_123308-8yp8mllr/logs/debug.log
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_init.py:_log_setup():525] Logging internal logs to /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/run-20231224_123308-8yp8mllr/logs/debug-internal.log
2023-12-24 12:33:08,476 INFO    MainThread:1927 [wandb_init.py:_jupyter_setup():470] configuring jupyter hooks <wandb.sdk.wandb_init._WandbInit object at 0x13afa6090>
2023-12-24 12:33:08,477 INFO    MainThread:1927 [wandb_init.py:init():564] calling init triggers
2023-12-24 12:33:08,477 INFO    MainThread:1927 [wandb_init.py:init():571] wandb.init called with sweep_config: {'LR': 0.005, 'activation': 'GEGLU', 'aux_loss_coef': 0.01, 'batch_size': 64, 'capacity_factor': 2, 'every_n_switch': 3, 'expert_dropout': 0.1, 'mlp_dropout': 0.2, 'n_experts': 8, 'norm_first': True, 'optimizer': 'adamw', 'switch_first': True}
config: {'method': 'random', 'metric': {'goal': 'minimize', 'name': 'val_loss'}, 'parameters': {'mlp_dropout': {'values': [0.1, 0.15, 0.2, 0.3, 0.4]}, 'expert_dropout': {'values': [0.1, 0.15, 0.2, 0.3, 0.4]}, 'LR': {'values': [0.0005, 0.001, 0.003, 0.005, 0.01]}, 'batch_size': {'values': [16, 32, 64, 128, 256, 512]}, 'optimizer': {'values': ['adamw', 'sgd', 'momentum']}, 'activation': {'values': ['GELU', 'GEGLU', 'SwiGLU']}, 'n_experts': {'values': [2, 4, 8, 16, 32, 64]}, 'capacity_factor': {'values': [0.5, 0.75, 1, 1.25, 1.5, 1.75, 2]}, 'aux_loss_coef': {'values': [0.005, 0.01, 0.05, 0.1, 0.2]}, 'norm_first': {'values': [True, False]}, 'switch_first': {'values': [True, False]}, 'every_n_switch': {'values': [1, 2, 3, 4]}}, 'early_terminate': {'type': 'hyperband', 's': 2, 'eta': 3, 'max_iter': 27}}
2023-12-24 12:33:08,477 INFO    MainThread:1927 [wandb_init.py:init():614] starting backend
2023-12-24 12:33:08,477 INFO    MainThread:1927 [wandb_init.py:init():618] setting up manager
2023-12-24 12:33:08,483 INFO    MainThread:1927 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2023-12-24 12:33:08,483 INFO    MainThread:1927 [wandb_init.py:init():624] backend started and connected
2023-12-24 12:33:08,542 INFO    MainThread:1927 [wandb_run.py:_config_callback():1342] config_cb None None {'LR': 0.005, 'activation': 'GEGLU', 'aux_loss_coef': 0.01, 'batch_size': 64, 'capacity_factor': 2, 'every_n_switch': 3, 'expert_dropout': 0.1, 'mlp_dropout': 0.2, 'n_experts': 8, 'norm_first': True, 'optimizer': 'adamw', 'switch_first': True}
2023-12-24 12:33:08,545 INFO    MainThread:1927 [wandb_run.py:_label_probe_notebook():1294] probe notebook
2023-12-24 12:33:08,545 INFO    MainThread:1927 [wandb_run.py:_label_probe_notebook():1304] Unable to probe notebook: 'NoneType' object has no attribute 'get'
2023-12-24 12:33:08,545 INFO    MainThread:1927 [wandb_init.py:init():716] updated telemetry
2023-12-24 12:33:08,575 INFO    MainThread:1927 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2023-12-24 12:33:08,891 INFO    MainThread:1927 [wandb_run.py:_on_init():2254] communicating current version
2023-12-24 12:33:09,063 INFO    MainThread:1927 [wandb_run.py:_on_init():2263] got version response 
2023-12-24 12:33:09,063 INFO    MainThread:1927 [wandb_init.py:init():800] starting run threads in backend
2023-12-24 12:33:12,289 INFO    MainThread:1927 [wandb_run.py:_console_start():2233] atexit reg
2023-12-24 12:33:12,289 INFO    MainThread:1927 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2023-12-24 12:33:12,289 INFO    MainThread:1927 [wandb_run.py:_redirect():2153] Wrapping output streams.
2023-12-24 12:33:12,290 INFO    MainThread:1927 [wandb_run.py:_redirect():2178] Redirects installed.
2023-12-24 12:33:12,291 INFO    MainThread:1927 [wandb_init.py:init():841] run started, returning control to user process
2023-12-24 12:33:12,292 INFO    MainThread:1927 [wandb_run.py:_finish():1962] finishing run terru3/switch_moe/8yp8mllr
2023-12-24 12:33:12,292 INFO    MainThread:1927 [jupyter.py:save_history():445] not saving jupyter history
2023-12-24 12:33:12,293 INFO    MainThread:1927 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2023-12-24 12:33:12,293 INFO    MainThread:1927 [wandb_init.py:_jupyter_teardown():452] cleaning up jupyter logic
2023-12-24 12:33:12,293 INFO    MainThread:1927 [wandb_run.py:_atexit_cleanup():2202] got exitcode: 0
2023-12-24 12:33:12,293 INFO    MainThread:1927 [wandb_run.py:_restore():2185] restore
2023-12-24 12:33:12,293 INFO    MainThread:1927 [wandb_run.py:_restore():2191] restore done
2023-12-24 12:33:17,077 INFO    MainThread:1927 [wandb_run.py:_footer_history_summary_info():3837] rendering history
2023-12-24 12:33:17,077 INFO    MainThread:1927 [wandb_run.py:_footer_history_summary_info():3869] rendering summary
2023-12-24 12:33:17,082 INFO    MainThread:1927 [wandb_run.py:_footer_sync_info():3796] logging synced files
