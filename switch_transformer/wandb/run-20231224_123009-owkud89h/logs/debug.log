2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Current SDK version is 0.16.1
2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Configure stats pid to 1927
2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Loading settings from /Users/Terru/.config/wandb/settings
2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Loading settings from /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/settings
2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'project': 'switch_moe', 'entity': 'terru3', 'root_dir': '/Users/Terru/Desktop/self-learn/moe-kit/switch_transformer', 'sweep_id': 'qdyn9o0q', 'run_id': 'owkud89h', 'sweep_param_path': '/Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/sweep-qdyn9o0q/config-owkud89h.yaml'}
2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-12-24 12:30:09,392 INFO    Thread-10 (_run_job):1927 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program': '<python with no main file>'}
2023-12-24 12:30:09,393 INFO    Thread-10 (_run_job):1927 [wandb_init.py:_log_setup():524] Logging user logs to /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/run-20231224_123009-owkud89h/logs/debug.log
2023-12-24 12:30:09,393 INFO    Thread-10 (_run_job):1927 [wandb_init.py:_log_setup():525] Logging internal logs to /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/run-20231224_123009-owkud89h/logs/debug-internal.log
2023-12-24 12:30:09,393 INFO    Thread-10 (_run_job):1927 [wandb_init.py:_jupyter_setup():470] configuring jupyter hooks <wandb.sdk.wandb_init._WandbInit object at 0x13a432390>
2023-12-24 12:30:09,394 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():564] calling init triggers
2023-12-24 12:30:09,394 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():571] wandb.init called with sweep_config: {'LR': 0.0005, 'activation': 'SwiGLU', 'aux_loss_coef': 0.1, 'batch_size': 64, 'capacity_factor': 1.75, 'every_n_switch': 3, 'expert_dropout': 0.1, 'mlp_dropout': 0.15, 'n_experts': 4, 'norm_first': True, 'optimizer': 'sgd', 'switch_first': False}
config: {}
2023-12-24 12:30:09,394 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():614] starting backend
2023-12-24 12:30:09,394 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():618] setting up manager
2023-12-24 12:30:09,403 INFO    Thread-10 (_run_job):1927 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2023-12-24 12:30:09,405 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():624] backend started and connected
2023-12-24 12:30:09,417 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_config_callback():1342] config_cb None None {'LR': 0.0005, 'activation': 'SwiGLU', 'aux_loss_coef': 0.1, 'batch_size': 64, 'capacity_factor': 1.75, 'every_n_switch': 3, 'expert_dropout': 0.1, 'mlp_dropout': 0.15, 'n_experts': 4, 'norm_first': True, 'optimizer': 'sgd', 'switch_first': False}
2023-12-24 12:30:09,420 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_label_probe_notebook():1294] probe notebook
2023-12-24 12:30:09,420 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_label_probe_notebook():1304] Unable to probe notebook: 'NoneType' object has no attribute 'get'
2023-12-24 12:30:09,420 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():716] updated telemetry
2023-12-24 12:30:09,474 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2023-12-24 12:30:10,028 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_on_init():2254] communicating current version
2023-12-24 12:30:10,200 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_on_init():2263] got version response 
2023-12-24 12:30:10,200 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():800] starting run threads in backend
2023-12-24 12:30:15,199 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_console_start():2233] atexit reg
2023-12-24 12:30:15,200 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2023-12-24 12:30:15,200 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_redirect():2153] Wrapping output streams.
2023-12-24 12:30:15,200 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_redirect():2178] Redirects installed.
2023-12-24 12:30:15,203 INFO    Thread-10 (_run_job):1927 [wandb_init.py:init():841] run started, returning control to user process
2023-12-24 12:30:15,209 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_finish():1962] finishing run terru3/switch_moe/owkud89h
2023-12-24 12:30:15,210 INFO    Thread-10 (_run_job):1927 [jupyter.py:save_history():445] not saving jupyter history
2023-12-24 12:30:15,210 INFO    Thread-10 (_run_job):1927 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2023-12-24 12:30:15,210 INFO    Thread-10 (_run_job):1927 [wandb_init.py:_jupyter_teardown():452] cleaning up jupyter logic
2023-12-24 12:30:15,210 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_atexit_cleanup():2202] got exitcode: 1
2023-12-24 12:30:15,210 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_restore():2185] restore
2023-12-24 12:30:15,210 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_restore():2191] restore done
2023-12-24 12:30:20,386 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_footer_history_summary_info():3837] rendering history
2023-12-24 12:30:20,386 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_footer_history_summary_info():3869] rendering summary
2023-12-24 12:30:20,393 INFO    Thread-10 (_run_job):1927 [wandb_run.py:_footer_sync_info():3796] logging synced files
