2024-01-16 22:59:31,743 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Current SDK version is 0.16.1
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Configure stats pid to 17423
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Loading settings from /Users/Terru/.config/wandb/settings
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Loading settings from /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/settings
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'project': 'switch_moe', 'entity': 'terru3', 'root_dir': '/Users/Terru/Desktop/self-learn/moe-kit/switch_transformer', 'sweep_id': 'qw2sczpt', 'run_id': 'k6gurmob', 'sweep_param_path': '/Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/sweep-qw2sczpt/config-k6gurmob.yaml'}
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program': '<python with no main file>'}
2024-01-16 22:59:31,744 INFO    Thread-7 (_run_job):17423 [wandb_init.py:_log_setup():524] Logging user logs to /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/run-20240116_225931-k6gurmob/logs/debug.log
2024-01-16 22:59:31,745 INFO    Thread-7 (_run_job):17423 [wandb_init.py:_log_setup():525] Logging internal logs to /Users/Terru/Desktop/self-learn/moe-kit/switch_transformer/wandb/run-20240116_225931-k6gurmob/logs/debug-internal.log
2024-01-16 22:59:31,746 INFO    Thread-7 (_run_job):17423 [wandb_init.py:_jupyter_setup():470] configuring jupyter hooks <wandb.sdk.wandb_init._WandbInit object at 0x11e0c8d90>
2024-01-16 22:59:31,747 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():564] calling init triggers
2024-01-16 22:59:31,747 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():571] wandb.init called with sweep_config: {'LR': 0.003, 'activation': 'GEGLU', 'aux_loss_coef': 0.15, 'batch_size': 512, 'capacity_factor': 0.75, 'every_n_switch': 2, 'expert_dropout': 0.2, 'mlp_dropout': 0.2, 'n_experts': 8, 'norm_first': True, 'optimizer': 'sgd', 'rope_scale': 0.25, 'switch_first': False}
config: {}
2024-01-16 22:59:31,747 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():614] starting backend
2024-01-16 22:59:31,747 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():618] setting up manager
2024-01-16 22:59:31,757 INFO    Thread-7 (_run_job):17423 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2024-01-16 22:59:31,761 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():624] backend started and connected
2024-01-16 22:59:31,778 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_config_callback():1342] config_cb None None {'LR': 0.003, 'activation': 'GEGLU', 'aux_loss_coef': 0.15, 'batch_size': 512, 'capacity_factor': 0.75, 'every_n_switch': 2, 'expert_dropout': 0.2, 'mlp_dropout': 0.2, 'n_experts': 8, 'norm_first': True, 'optimizer': 'sgd', 'rope_scale': 0.25, 'switch_first': False}
2024-01-16 22:59:31,781 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_label_probe_notebook():1294] probe notebook
2024-01-16 22:59:31,782 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_label_probe_notebook():1304] Unable to probe notebook: 'NoneType' object has no attribute 'get'
2024-01-16 22:59:31,782 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():716] updated telemetry
2024-01-16 22:59:31,817 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():749] communicating run to backend with 90.0 second timeout
2024-01-16 22:59:32,115 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_on_init():2254] communicating current version
2024-01-16 22:59:32,212 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_on_init():2263] got version response upgrade_message: "wandb version 0.16.2 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-01-16 22:59:32,212 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():800] starting run threads in backend
2024-01-16 22:59:36,465 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_console_start():2233] atexit reg
2024-01-16 22:59:36,465 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_redirect():2088] redirect: wrap_raw
2024-01-16 22:59:36,466 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_redirect():2153] Wrapping output streams.
2024-01-16 22:59:36,466 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_redirect():2178] Redirects installed.
2024-01-16 22:59:36,467 INFO    Thread-7 (_run_job):17423 [wandb_init.py:init():841] run started, returning control to user process
2024-01-16 23:01:03,050 INFO    MainThread:17423 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-01-16 23:01:03,050 INFO    MainThread:17423 [wandb_init.py:_pause_backend():435] pausing backend
2024-01-16 23:01:06,324 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_finish():1962] finishing run terru3/switch_moe/k6gurmob
2024-01-16 23:01:06,324 INFO    Thread-7 (_run_job):17423 [jupyter.py:save_history():445] not saving jupyter history
2024-01-16 23:01:06,324 INFO    Thread-7 (_run_job):17423 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-01-16 23:01:06,324 INFO    Thread-7 (_run_job):17423 [wandb_init.py:_jupyter_teardown():452] cleaning up jupyter logic
2024-01-16 23:01:06,324 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_atexit_cleanup():2202] got exitcode: 1
2024-01-16 23:01:06,325 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_restore():2185] restore
2024-01-16 23:01:06,325 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_restore():2191] restore done
2024-01-16 23:01:09,704 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_footer_history_summary_info():3837] rendering history
2024-01-16 23:01:09,705 INFO    Thread-7 (_run_job):17423 [wandb_run.py:_footer_history_summary_info():3869] rendering summary
